<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Dashboard - GPT Sweetheart</title>
<style>
    body { font-family: sans-serif; background-color: #0d0d0d; color: #fff; padding: 2rem; }
    h1 { color: #ff2e88; }
    .card { background-color: #1a1a1a; padding: 1rem; border-radius: 8px; margin-bottom: 1rem; }
    button { padding: 0.5rem 1rem; border: none; border-radius: 4px; background-color: #ff2e88; color: white; cursor: pointer; }
    button:hover { background-color: #e02677; }
</style>
<script src="https://unpkg.com/@supabase/supabase-js"></script>
<script>
const supabase = supabase.createClient("https://rdwwpjfwsoufgbpihykn.supabase.co", "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJkd3dwamZ3c291ZmdicGloeWtuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ4MzUyNTcsImV4cCI6MjA3MDQxMTI1N30.34g9cl9e3aep-iJEPkOgbkpHja07xRSv7QigfpyeiMI");
(async () => {
    const token = localStorage.getItem("access_token");
    if (!token) { window.location.href = "/login"; return; }

    const res = await fetch("/api/me", { headers: { "Authorization": "Bearer " + token }});
    if (!res.ok) { alert("Error fetching data"); return; }
    const data = await res.json();
    document.getElementById("plan").innerText = data.plan;
    document.getElementById("credits").innerText = data.credits;
})();

async function upgrade() {
    const token = localStorage.getItem("access_token");
    const res = await fetch("/api/upgrade", {
        method: "POST",
        headers: { "Authorization": "Bearer " + token }
    });
    const data = await res.json();
    if (data.url) { window.location.href = data.url; }
}
</script>
</head>
<body>
<h1>Dashboard</h1>
<div class="card">
    <p>Current Plan: <span id="plan">...</span></p>
    <p>Credits: <span id="credits">...</span></p>
</div>
<div class="card">
    <button onclick="upgrade()">Upgrade to Pro</button>
</div>
</body>
</html>
